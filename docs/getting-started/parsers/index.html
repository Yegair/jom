<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/jom/blog/rss.xml" title="jom Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/jom/blog/atom.xml" title="jom Blog Atom Feed"><title data-react-helmet="true">Parser Basics | jom</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Parser Basics | jom"><meta data-react-helmet="true" name="description" content="A Parser is the basic building block of jom."><meta data-react-helmet="true" property="og:description" content="A Parser is the basic building block of jom."><meta data-react-helmet="true" property="og:url" content="https://yegair.io/jom/jom/docs/getting-started/parsers"><link data-react-helmet="true" rel="shortcut icon" href="/jom/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://yegair.io/jom/jom/docs/getting-started/parsers"><link rel="stylesheet" href="/jom/styles.32a5261b.css">
<link rel="stylesheet" href="/jom/main.1a7f1918.css">
<link rel="preload" href="/jom/styles.1073ac1d.js" as="script">
<link rel="preload" href="/jom/runtime~main.b9665463.js" as="script">
<link rel="preload" href="/jom/main.075f04df.js" as="script">
<link rel="preload" href="/jom/1.81bb2c35.js" as="script">
<link rel="preload" href="/jom/2.aae2aa27.js" as="script">
<link rel="preload" href="/jom/18.b4361dff.js" as="script">
<link rel="preload" href="/jom/19.b7813490.js" as="script">
<link rel="preload" href="/jom/935f2afb.34be9db4.js" as="script">
<link rel="preload" href="/jom/17896441.0c0b2346.js" as="script">
<link rel="preload" href="/jom/0e8c326e.ced2d9b3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/jom/"><img src="/jom/img/logo.svg" alt="jom Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/jom/img/logo.svg" alt="jom Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">jom</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/jom/docs/">Docs</a><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" href="/jom/api/jom/index.html">API</a><a class="navbar__item navbar__link" href="/jom/docs/examples/json">Examples</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Yegair/jom" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/jom/"><img src="/jom/img/logo.svg" alt="jom Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/jom/img/logo.svg" alt="jom Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">jom</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/jom/docs/">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link" href="/jom/api/jom/index.html">API</a></li><li class="menu__list-item"><a class="menu__link" href="/jom/docs/examples/json">Examples</a></li><li class="menu__list-item"><a href="https://github.com/Yegair/jom" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/jom/docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/jom/docs/getting-started/">Installation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/jom/docs/getting-started/parsers">Parser Basics</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Parser Basics</h1></header><div class="markdown"><p>A <a href="/jom/api/jom/io.yegair.jom/-parser"><code>Parser</code></a> is the basic building block of <em>jom</em>.
It essentially is a function which consumes <a href="/jom/api/jom/io.yegair.jom/-input"><code>Input</code></a>,
and returns a <a href="/jom/api/jom/io.yegair.jom/-parse-result"><code>ParseResult</code></a>.
A <code>ParseResult</code> can be in one of two states, <code>ok</code> or <code>not-ok</code> (aka. <code>error</code>).
<code>ok</code> indicates that the parser was able to recognize the input and produced some
<a href="/jom/api/jom/io.yegair.jom/-parse-result/output.html"><code>output</code></a>.
<code>not-ok</code> indicates that the parser was unable to recognize the input and produced a
<a href="/jom/api/jom/io.yegair.jom/-parse-error"><code>ParseError</code></a> instead.
A <code>ParseResult</code> also contains the <a href="/jom/api/jom/io.yegair.jom/-parse-result/remaining.html"><code>remaining</code></a> input,
which is the input that has not be consumed by the parser.</p><p>For example lets have a look at one of the most basic parsers
<a href="/jom/api/jom/io.yegair.jom/-parsers/alpha1.html"><code>alpha1</code></a>.
It parses one or more alphabetical characters,
and is defined as <code>Parser&lt;String&gt;</code> which means that it will produce a <code>String</code> as its output.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val parser = Parsers.alpha1()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;abc&quot;)) // prints Ok[abc]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;ab1&quot;)) // prints Ok[ab]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;123&quot;)) // prints Error[Alpha]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>All predefined parsers are defined in <a href="/jom/api/jom/io.yegair.jom/-parsers"><code>Parsers</code></a>.
Have a look at the API docs to get an overview.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="combinators"></a>Combinators<a class="hash-link" href="#combinators" title="Direct link to heading">#</a></h2><p>A <code>Combinator</code> is a higher-order <code>Parser</code>.
It <em>combines</em> other, so called <em>embedded</em> parsers, into a new parser.
Since combinators are themselves parsers, they can also be embedded into other combinators.
This way the existing basic <a href="/jom/api/jom/io.yegair.jom/-parsers"><code>Parsers</code></a>
and <a href="/jom/api/jom/io.yegair.jom/-combinators"><code>Combinators</code></a> can be combined in any thinkable way,
in order to create exactly the parser one needs.</p><p>As an example lets have a look at <a href="/jom/api/jom/io.yegair.jom/-combinators/alt.html"><code>alt</code></a>,
which is one of the most common and most powerful combinators.
It takes multiple embedded parsers and applies them in order until one of the parsers recognizes the input.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val parser = Combinators.alt(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.alpha1(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.digit1()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;abc&quot;)) // prints Ok[abc]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;ab1&quot;)) // prints Ok[ab]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;123&quot;)) // prints Ok[123]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;12a&quot;)) // prints Ok[12]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;!12a&quot;)) // prints Error[Digit]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This works because <a href="/jom/api/jom/io.yegair.jom/-parsers/alpha1.html"><code>alpha1</code></a>
and <a href="/jom/api/jom/io.yegair.jom/-parsers/digit1.html"><code>digit1</code></a> both produce <code>String</code> outputs.
So the resulting parser is also of type <code>Parser&lt;String&gt;</code>.
But what if we wanted to also parse the character <code>&#x27;!&#x27;</code>?</p><p>A first attempt might look like this:</p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Compile Error</h5></div><div class="admonition-content"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val parser = Combinators.alt(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.alpha1(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.digit1(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.codePoint(&#x27;!&#x27;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div><p>This won&#x27;t compile,
because <a href="/jom/api/jom/io.yegair.jom/-parsers/code-point.html"><code>codePoint</code></a> returns a Parser of type <code>Parser&lt;Utf8CodePoint&gt;</code>.
However, we can use another combinator <a href="/jom/api/jom/io.yegair.jom/-combinators/map.html"><code>map</code></a> to make this work.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val parser = Combinators.alt(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.alpha1(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Parsers.digit1(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Combinators.map(Parsers.codePoint(&#x27;!&#x27;)) { it.utf8() }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;abc&quot;)) // prints Ok[abc]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;ab1&quot;)) // prints Ok[ab]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;123&quot;)) // prints Ok[123]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;12a&quot;)) // prints Ok[12]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">println(parser.parse(&quot;!1a&quot;)) // prints Ok[!]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>All predefined combinators are defined in <a href="/jom/api/jom/io.yegair.jom/-combinators"><code>Combinators</code></a>.
Have a look at the API docs to get an overview.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="input"></a>Input<a class="hash-link" href="#input" title="Direct link to heading">#</a></h2><p><a href="/jom/api/jom/io.yegair.jom/-input"><code>Input</code></a> is a simple abstraction over a stream of bytes.
It is the only parameter that is passed to a parser,
so it&#x27;s interface determines the overall capability of <em>jom</em> parsers.</p><blockquote><p>Up to now we have only seen parsers being invoked with <code>String</code> parameters,
so how can <code>Input</code> be the only parameter for a <code>Parser</code> you might ask?
Actually an expression of the form</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">parser.parse(&quot;foobar&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>is just shorthand for</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">parser.parse(Input.of(&quot;foobar&quot;))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></blockquote><p><code>Input</code> instances can be created from various sources such as
<code>String</code>,
<code>ByteArray</code> (Java <code>byte[]</code>),
<code>java.io.InputStream</code>,
<a href="https://square.github.io/okio/2.x/okio/okio/-source" target="_blank" rel="noopener noreferrer"><code>okio.Source</code></a>,
and <a href="https://square.github.io/okio/2.x/okio/okio/-byte-string" target="_blank" rel="noopener noreferrer"><code>okio.ByteString</code></a>.
No matter the source, creating an <code>Input</code> always works the same,
as an example let&#x27;s parse the contents of a file using the classic Java Files API.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Files.newInputStream(Paths.get(&quot;/path/to/my/file&quot;)).use { inputStream -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val input = Input.of(inputStream)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val result = myParser.parse(input)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  when {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    result.ok -&gt; result.output</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    else -&gt; throw RuntimeException(&quot;could not parse $pathToMyFile&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>There is also an alternative way using <a href="https://square.github.io/okio/" target="_blank" rel="noopener noreferrer">Okio</a>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Paths.get(&quot;/path/to/my/file&quot;).source().use { source -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val input = Input.of(source)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val result = myParser.parse(input)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  when {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    result.ok -&gt; result.output</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    else -&gt; throw RuntimeException(&quot;could not parse $pathToMyFile&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Under the hood <code>Input</code> makes heavy use of <a href="https://square.github.io/okio/2.x/okio/okio/-buffered-source" target="_blank" rel="noopener noreferrer"><code>okio.BufferedSource</code></a>,
so internally the <code>java.io.InputStream</code> would be wrapped by Okio anyway.
Hence, there is no real difference between the two approaches in terms of efficiency.</p><p>The most important point of these examples is, that <code>Input</code> instances do not manage their underlying source.
Thus, the caller must care about closing the <code>InputStream</code> or <code>Source</code> once the parser is done.
Also, the <code>ParseResult</code> of a parser holds a reference to the <code>Input</code>,
so the result also becomes &quot;invalid&quot; when the underlying <code>InputStream</code> or <code>Source</code> is closed.
In this case for example the <code>ParseResult</code> itself should not be returned from the <code>use</code> block.
However, the <code>output</code> of a <code>ParseResult</code> can safely be returned.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="parseresult"></a>ParseResult<a class="hash-link" href="#parseresult" title="Direct link to heading">#</a></h2><p><a href="/jom/api/jom/io.yegair.jom/-parse-result"><code>ParseResult</code></a> is a simple wrapper for the result of a parser.
It&#x27;s <a href="/jom/api/jom/io.yegair.jom/-parse-result/ok.html"><code>ok</code></a> property indicates whether a parser was
successful or has failed recognizing the input.
If <code>ok</code> is <code>true</code> the parser was successful, and the result of the parser can be obtained via the
<a href="/jom/api/jom/io.yegair.jom/-parse-result/output.html"><code>output</code></a> property.
Otherwise, the parser failed and trying to access the <code>output</code> property results in an <code>IllegalStateException</code> being
thrown.
If the parser failed the <a href="/jom/api/jom/io.yegair.jom/-parse-result/error.html"><code>error</code></a> property holds the
parse error which describes the cause of the failure.
Accessing the <code>error</code> property on a successful parse result also causes an <code>IllegalStateException</code> being thrown.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The error reporting capabilities of <em>jom</em> are currently extremely limited.
Better error reporting will be implemented in a future version.</p></div></div><p><code>ParseResult</code> also provides some monadic methods for working with <code>output</code> and <code>error</code>,
without having to check whether <code>ok</code> is <code>true</code> or <code>false</code>.
For example, it is possible to <a href="/jom/api/jom/io.yegair.jom/-parse-result/map.html"><code>map</code></a> the output value of
successful parse results:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val result = myIntParser</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  .parse(input.peek())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // this mapping will be called when the parser succeeds</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  .map { remaining, output -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    when (output) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      // we can use map to change the result type (in this case to Boolean)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      42 -&gt; ParseResult.ok(remaining, true)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      // we can also transform a successful parse result into an error</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      13 -&gt; ParseResult.error(input, ParseError.Digit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      else -&gt; ParseResult.ok(remaining, false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>It is also possible to map the error, however in that case we need to map successful outputs as well as errors,
in order to keep our type-safety.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val result = myIntParser</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  .parse(input.peek())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  .map(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // this mapping will be called when the parser succeeds</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ok = { remaining, output -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      when (output) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        13 -&gt; ParseResult.error(input, ParseError.Digit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else -&gt; ParseResult.ok(remaining, output)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // this mapping will be called when the parser fails</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    error = { remaining, err -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      when (err) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          // we can transform a failed parse result into a success</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          ParseError.Eof -&gt; ParseResult.ok(remaining, -1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          // we can also alter the error itself</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          else -&gt; ParseResult.error(remaining, ParseError.Digit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="custom-parsers"></a>Custom Parsers<a class="hash-link" href="#custom-parsers" title="Direct link to heading">#</a></h2><p>Sometimes the predefined <a href="/jom/api/jom/io.yegair.jom/-parsers"><code>Parsers</code></a>
and <a href="/jom/api/jom/io.yegair.jom/-combinators"><code>Combinators</code></a>
might not be enough to implement exactly the parser one needs.
In such hopefully rare cases it is possible to implement custom parsers from scratch.
For example lets assume we want write a custom parser which parses exactly one alphabetical letter.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">val customParser = Parser { input -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // we don&#x27;t know whether the next codepoint is alphabetical,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // so we have to peek instead of just consuming it</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val remaining = input.peek()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // consume the next UTF-8 codepoint from the peeking input</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // this will leave the original input unchanged</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  val codePoint = remaining.readUtf8CodePoint()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  when {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // check whether the parsed code point is the special EOF code point</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // which indicates that the end of the given input has been reached</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Input.isEof(codePoint) -&gt; ParseResult.error(input, ParseError.Eof)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // if the codepoint is alphabetical</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // return it together with the remaining input</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    codePoint.isAlpha() -&gt; ParseResult.ok(remaining, codePoint)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // otherwise return the original input and an appropriate error</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    else -&gt; ParseResult.error(input, ParseError.CodePoint)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Of course, it is also possible to implement a parser in a more classical way:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">class CustomParser : Parser&lt;Utf8CodePoint&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  override fun parse(input: Input): ParseResult&lt;Utf8CodePoint&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // the implementation is the same as above...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Using <code>class</code> or <code>object</code> instead of <code>val</code> can help when there are multiple parsers,
that are circular dependent on each other,
since that is not possible with simple variables.
In such cases there is also the possibility to implement parsers as simple methods,
if <code>class</code> or <code>object</code> per parser seems to verbose:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-kotlin codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">object MyParsers {</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  fun customParser1(input: Input): ParseResult&lt;Utf8CodePoint&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // the implementation is also the same as above...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  fun customParser2(input: Input): ParseResult&lt;Utf8CodePoint&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // another implementation</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  fun customCombinator(input: Input): ParseResult&lt;Utf8CodePoint&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return Combinators.alt(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      ::customParser1,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      ::customParser2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ).parse(input)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Yegair/jom/edit/main/pages/docs/getting-started/parsers.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/jom/docs/getting-started/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#combinators" class="table-of-contents__link">Combinators</a></li><li><a href="#input" class="table-of-contents__link">Input</a></li><li><a href="#parseresult" class="table-of-contents__link">ParseResult</a></li><li><a href="#custom-parsers" class="table-of-contents__link">Custom Parsers</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/jom/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/jom/docs/api/Input">API</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/jom" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Yegair/jom" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Hauke JÃ¤ger. Built with Docusaurus.</div></div></div></footer></div>
<script src="/jom/styles.1073ac1d.js"></script>
<script src="/jom/runtime~main.b9665463.js"></script>
<script src="/jom/main.075f04df.js"></script>
<script src="/jom/1.81bb2c35.js"></script>
<script src="/jom/2.aae2aa27.js"></script>
<script src="/jom/18.b4361dff.js"></script>
<script src="/jom/19.b7813490.js"></script>
<script src="/jom/935f2afb.34be9db4.js"></script>
<script src="/jom/17896441.0c0b2346.js"></script>
<script src="/jom/0e8c326e.ced2d9b3.js"></script>
</body>
</html>